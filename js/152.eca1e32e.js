"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[152],{9710:function(e,t,a){a.d(t,{A:function(){return g}});var n=a(4061);const i={class:"cancel-modal"},l={class:"cancel-modal__box"},s={class:"cancel-modal__actions"},r=["disabled"],o={key:0,class:"cancel-modal__spinner"};function c(e,t,a,c,d,m){return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.createElementVNode)("div",l,[t[4]||(t[4]=(0,n.createElementVNode)("h3",{class:"cancel-modal__title"},"Cancel Listing",-1)),t[5]||(t[5]=(0,n.createElementVNode)("p",{class:"cancel-modal__message"},"Are you sure you want to cancel this listing?",-1)),(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("button",{type:"button",class:"cancel-modal__button cancel-modal__button--secondary",onClick:t[0]||(t[0]=t=>e.$emit("close"))}," No, Keep Listing "),(0,n.createElementVNode)("button",{onClick:t[1]||(t[1]=t=>e.$emit("confirm")),class:"cancel-modal__button cancel-modal__button--danger",disabled:a.isSubmitting},[a.isSubmitting?((0,n.openBlock)(),(0,n.createElementBlock)("span",o)):(0,n.createCommentVNode)("",!0),t[3]||(t[3]=(0,n.createTextVNode)(" Yes, Cancel Listing "))],8,r)])]),(0,n.createElementVNode)("div",{class:"cancel-modal__backdrop",onClick:t[2]||(t[2]=t=>e.$emit("close"))})])}var d={name:"CancelListingModal",props:{isSubmitting:{type:Boolean,default:!1}}},m=a(1241);const u=(0,m.A)(d,[["render",c],["__scopeId","data-v-f36f194a"]]);var g=u},6241:function(e,t,a){a.d(t,{A:function(){return w}});var n=a(4061);const i={class:"bid-modal"},l={class:"bid-modal__box"},s={class:"bid-modal__nft-preview"},r={class:"bid-modal__nft-image-container"},o=["src","alt"],c={key:1,class:"bid-modal__nft-placeholder"},d={class:"bid-modal__nft-name"},m={class:"bid-modal__form-group"},u=["value"],g={class:"bid-modal__form-group"},_=["min"],f={class:"bid-modal__form-help"},p={class:"bid-modal__fee-summary"},b={class:"bid-modal__fee-row"},N={class:"bid-modal__fee-row bid-modal__fee-row--total"},k={class:"bid-modal__actions"},v=["disabled"],E={key:0,class:"bid-modal__spinner"};function h(e,t,a,h,y,V){return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.createElementVNode)("div",l,[t[11]||(t[11]=(0,n.createElementVNode)("h3",{class:"bid-modal__title"},"Place Bid",-1)),(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("div",r,[a.listing.imageUrl?((0,n.openBlock)(),(0,n.createElementBlock)("img",{key:0,src:a.listing.imageUrl,alt:a.listing.name,class:"bid-modal__nft-image"},null,8,o)):((0,n.openBlock)(),(0,n.createElementBlock)("div",c,t[4]||(t[4]=[(0,n.createElementVNode)("i",{class:"fas fa-image bid-modal__nft-placeholder-icon"},null,-1)])))]),(0,n.createElementVNode)("h4",d,(0,n.toDisplayString)(a.listing.name||`NFT #${a.listing.mintAddress.substring(0,8)}`),1)]),(0,n.createElementVNode)("form",{onSubmit:t[2]||(t[2]=(0,n.withModifiers)(((...e)=>V.submitBid&&V.submitBid(...e)),["prevent"])),class:"bid-modal__form"},[(0,n.createElementVNode)("div",m,[t[5]||(t[5]=(0,n.createElementVNode)("label",{class:"bid-modal__form-label"},[(0,n.createElementVNode)("span",{class:"bid-modal__form-label-text"},"Current Price")],-1)),(0,n.createElementVNode)("input",{value:V.formatPrice(a.listing.highestBid||a.listing.initialPrice),type:"text",class:"bid-modal__form-input bid-modal__form-input--disabled",disabled:""},null,8,u)]),(0,n.createElementVNode)("div",g,[t[6]||(t[6]=(0,n.createElementVNode)("label",{class:"bid-modal__form-label"},[(0,n.createElementVNode)("span",{class:"bid-modal__form-label-text"},"Your Bid (SOL)")],-1)),(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y.bidAmount=e),type:"number",step:"0.01",min:V.minBidAmount,placeholder:"Enter bid amount",class:"bid-modal__form-input",required:""},null,8,_),[[n.vModelText,y.bidAmount]]),(0,n.createElementVNode)("span",f,"Minimum bid: "+(0,n.toDisplayString)(V.minBidAmount)+" SOL",1)]),(0,n.createElementVNode)("div",p,[t[9]||(t[9]=(0,n.createElementVNode)("h4",{class:"bid-modal__fee-title"},"Fees",-1)),(0,n.createElementVNode)("div",b,[t[7]||(t[7]=(0,n.createElementVNode)("span",null,"Marketplace Fee (5%)",-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(V.calculateFee())+" SOL",1)]),(0,n.createElementVNode)("div",N,[t[8]||(t[8]=(0,n.createElementVNode)("span",null,"Total",-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(V.calculateTotal())+" SOL",1)])]),(0,n.createElementVNode)("div",k,[(0,n.createElementVNode)("button",{type:"button",class:"bid-modal__button bid-modal__button--cancel",onClick:t[1]||(t[1]=t=>e.$emit("close"))},"Cancel"),(0,n.createElementVNode)("button",{type:"submit",class:"bid-modal__button bid-modal__button--submit",disabled:a.isSubmitting||!V.isFormValid},[a.isSubmitting?((0,n.openBlock)(),(0,n.createElementBlock)("span",E)):(0,n.createCommentVNode)("",!0),t[10]||(t[10]=(0,n.createTextVNode)(" Place Bid "))],8,v)])],32)]),(0,n.createElementVNode)("div",{class:"bid-modal__backdrop",onClick:t[3]||(t[3]=t=>e.$emit("close"))})])}var y={name:"PlaceBidModal",props:{listing:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1}},data(){return{bidAmount:""}},computed:{minBidAmount(){const e=this.listing.highestBid||this.listing.initialPrice;return(parseFloat(e)+.01).toFixed(2)},isFormValid(){return this.bidAmount&&parseFloat(this.bidAmount)>=parseFloat(this.minBidAmount)}},methods:{formatPrice(e){return parseFloat(e).toFixed(3)},calculateFee(){if(!this.bidAmount)return"0";const e=.05*parseFloat(this.bidAmount);return e.toFixed(3)},calculateTotal(){if(!this.bidAmount)return"0";const e=parseFloat(this.bidAmount),t=.05*e;return(e+t).toFixed(3)},submitBid(){this.isFormValid&&this.$emit("submit",{mintAddress:this.listing.mintAddress,amount:parseFloat(this.bidAmount)})}},mounted(){this.bidAmount=this.minBidAmount}},V=a(1241);const B=(0,V.A)(y,[["render",h],["__scopeId","data-v-fe5ce5c6"]]);var w=B},8152:function(e,t,a){a.r(t),a.d(t,{default:function(){return Be}});var n=a(4061);const i={class:"nft-market"},l={class:"nft-market__container"},s={key:0,class:"nft-market__create-section"},r={class:"nft-market__listings-section"},o={class:"nft-market__listings-header"},c={class:"nft-market__listings-controls"},d=["disabled"],m={key:0,class:"nft-market__tab-buttons"},u={key:0,class:"nft-market__loader-container"},g={key:1,class:"nft-market__empty-state"},_={key:0,class:"nft-market__empty-subtitle"},f={key:1,class:"nft-market__empty-subtitle"},p={key:2,class:"nft-market__listings-grid"};function b(e,t,a,b,N,k){const v=(0,n.resolveComponent)("NftListingCard"),E=(0,n.resolveComponent)("CreateListingModal"),h=(0,n.resolveComponent)("PlaceBidModal"),y=(0,n.resolveComponent)("CancelListingModal");return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.createElementVNode)("div",l,[t[13]||(t[13]=(0,n.createElementVNode)("h1",{class:"nft-market__title"},"NFT Marketplace",-1)),b.wallet&&b.connected?((0,n.openBlock)(),(0,n.createElementBlock)("div",s,[t[7]||(t[7]=(0,n.createElementVNode)("h2",{class:"nft-market__section-title"},"Sell Your NFT",-1)),t[8]||(t[8]=(0,n.createElementVNode)("p",{class:"nft-market__section-description"},"List your NFT for sale on our marketplace and earn SOL.",-1)),(0,n.createElementVNode)("button",{onClick:t[0]||(t[0]=e=>b.showCreateListingModal=!0),class:"nft-market__create-button"}," Create Listing ")])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",r,[(0,n.createElementVNode)("div",o,[t[10]||(t[10]=(0,n.createElementVNode)("h2",{class:"nft-market__section-title"},"Active Listings",-1)),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("button",{onClick:t[1]||(t[1]=(...e)=>b.loadListings&&b.loadListings(...e)),class:"nft-market__refresh-button",disabled:b.isLoading},t[9]||(t[9]=[(0,n.createElementVNode)("i",{class:"fas fa-sync-alt nft-market__refresh-icon"},null,-1),(0,n.createTextVNode)(" Refresh ")]),8,d),b.wallet&&b.connected?((0,n.openBlock)(),(0,n.createElementBlock)("div",m,[(0,n.createElementVNode)("button",{onClick:t[2]||(t[2]=e=>b.activeTab="all"),class:(0,n.normalizeClass)(["nft-market__tab-button",{"nft-market__tab-button--active":"all"===b.activeTab}])}," All ",2),(0,n.createElementVNode)("button",{onClick:t[3]||(t[3]=e=>b.activeTab="my"),class:(0,n.normalizeClass)(["nft-market__tab-button",{"nft-market__tab-button--active":"my"===b.activeTab}])}," My Listings ",2)])):(0,n.createCommentVNode)("",!0)])]),b.isLoading?((0,n.openBlock)(),(0,n.createElementBlock)("div",u,t[11]||(t[11]=[(0,n.createElementVNode)("div",{class:"nft-market__loader"},null,-1)]))):0===b.displayedListings.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",g,[t[12]||(t[12]=(0,n.createElementVNode)("p",{class:"nft-market__empty-title"},"No NFT listings found.",-1)),"my"===b.activeTab?((0,n.openBlock)(),(0,n.createElementBlock)("p",_," You haven't listed any NFTs for sale yet. ")):((0,n.openBlock)(),(0,n.createElementBlock)("p",f," Be the first to list your NFT on our marketplace! "))])):((0,n.openBlock)(),(0,n.createElementBlock)("div",p,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(b.displayedListings,(e=>((0,n.openBlock)(),(0,n.createBlock)(v,{key:e.id,listing:e,"wallet-address":b.walletAddress,connected:b.connected,onView:b.viewListing,onBid:b.placeBid,onCancel:b.cancelListing},null,8,["listing","wallet-address","connected","onView","onBid","onCancel"])))),128))]))])]),b.showCreateListingModal?((0,n.openBlock)(),(0,n.createBlock)(E,{key:0,"user-nfts":b.userNfts,"is-loading":b.isLoadingUserNfts,"is-submitting":b.isCreatingListing,onClose:t[4]||(t[4]=e=>b.showCreateListingModal=!1),onSubmit:b.handleCreateListing},null,8,["user-nfts","is-loading","is-submitting","onSubmit"])):(0,n.createCommentVNode)("",!0),b.showBidModal&&b.selectedListing?((0,n.openBlock)(),(0,n.createBlock)(h,{key:1,listing:b.selectedListing,"is-submitting":b.isPlacingBid,onClose:t[5]||(t[5]=e=>b.showBidModal=!1),onSubmit:b.handlePlaceBid},null,8,["listing","is-submitting","onSubmit"])):(0,n.createCommentVNode)("",!0),b.showCancelModal&&b.selectedListing?((0,n.openBlock)(),(0,n.createBlock)(y,{key:2,"is-submitting":b.isCancelling,onClose:t[6]||(t[6]=e=>b.showCancelModal=!1),onConfirm:b.handleCancelListing},null,8,["is-submitting","onConfirm"])):(0,n.createCommentVNode)("",!0)])}a(4114);var N=a(6659),k=a(3992),v=a(3719),E=a.n(v),h=a(5290);const y={class:"nft-card"},V={class:"nft-card__image-container"},B=["src","alt"],w={key:1,class:"nft-card__image-placeholder"},C={class:"nft-card__content"},L={class:"nft-card__title"},F={class:"nft-card__address"},P={key:0,class:"nft-card__seller"},A={class:"nft-card__seller-value"},S={class:"nft-card__price-container"},T={class:"nft-card__price-block"},D={class:"nft-card__price-value"},M={key:0,class:"nft-card__price-block"},x={class:"nft-card__price-value"},$={class:"nft-card__time-block"},O={class:"nft-card__time-value"},U={class:"nft-card__actions"};function I(e,t,a,i,l,s){return(0,n.openBlock)(),(0,n.createElementBlock)("div",y,[(0,n.createElementVNode)("div",V,[a.listing.imageUrl?((0,n.openBlock)(),(0,n.createElementBlock)("img",{key:0,src:a.listing.imageUrl,alt:a.listing.name,class:"nft-card__image"},null,8,B)):((0,n.openBlock)(),(0,n.createElementBlock)("div",w,t[3]||(t[3]=[(0,n.createElementVNode)("i",{class:"fas fa-image nft-card__placeholder-icon"},null,-1)]))),"active"!==a.listing.status?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:2,class:(0,n.normalizeClass)(["nft-card__status",{"nft-card__status--sold":"sold"===a.listing.status,"nft-card__status--cancelled":"cancelled"===a.listing.status,"nft-card__status--expired":"expired"===a.listing.status}])},(0,n.toDisplayString)(a.listing.status),3)):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("div",C,[(0,n.createElementVNode)("h3",L,(0,n.toDisplayString)(a.listing.name||`NFT #${a.listing.mintAddress.substring(0,8)}`),1),(0,n.createElementVNode)("p",F,(0,n.toDisplayString)(s.shortenAddress(a.listing.mintAddress)),1),a.listing.userTag?((0,n.openBlock)(),(0,n.createElementBlock)("div",P,[t[4]||(t[4]=(0,n.createElementVNode)("p",{class:"nft-card__seller-label"},"Seller:",-1)),(0,n.createElementVNode)("p",A,(0,n.toDisplayString)(a.listing.userTag),1)])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",S,[(0,n.createElementVNode)("div",T,[t[5]||(t[5]=(0,n.createElementVNode)("p",{class:"nft-card__price-label"},"Price",-1)),(0,n.createElementVNode)("p",D,(0,n.toDisplayString)(s.formatPrice(a.listing.initialPrice))+" SOL",1)]),a.listing.instantPrice?((0,n.openBlock)(),(0,n.createElementBlock)("div",M,[t[6]||(t[6]=(0,n.createElementVNode)("p",{class:"nft-card__price-label"},"Buy Now",-1)),(0,n.createElementVNode)("p",x,(0,n.toDisplayString)(s.formatPrice(a.listing.instantPrice))+" SOL",1)])):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("div",$,[t[7]||(t[7]=(0,n.createElementVNode)("p",{class:"nft-card__time-label"},"Ends in",-1)),(0,n.createElementVNode)("p",O,(0,n.toDisplayString)(s.formatTimeRemaining(a.listing.endTime)),1)]),(0,n.createElementVNode)("div",U,[(0,n.createElementVNode)("button",{onClick:t[0]||(t[0]=t=>e.$emit("view",a.listing)),class:"nft-card__button nft-card__button--view"}," View Details "),s.canBid?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,onClick:t[1]||(t[1]=t=>e.$emit("bid",a.listing)),class:"nft-card__button nft-card__button--bid"}," Place Bid ")):(0,n.createCommentVNode)("",!0),s.canCancel?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:1,onClick:t[2]||(t[2]=t=>e.$emit("cancel",a.listing)),class:"nft-card__button nft-card__button--cancel"}," Cancel ")):(0,n.createCommentVNode)("",!0)])])])}var q={name:"NftListingCard",props:{listing:{type:Object,required:!0},walletAddress:{type:String,default:""},connected:{type:Boolean,default:!1}},computed:{canBid(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet!==this.walletAddress},canCancel(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet===this.walletAddress}},methods:{formatPrice(e){return parseFloat(e).toFixed(3)},formatTimeRemaining(e){const t=new Date(e),a=new Date;if(t<=a)return"Ended";const n=t-a,i=Math.floor(n/864e5),l=Math.floor(n%864e5/36e5),s=Math.floor(n%36e5/6e4);return i>0?`${i}d ${l}h`:l>0?`${l}h ${s}m`:`${s}m`},shortenAddress(e){return e?`${e.substring(0,4)}...${e.substring(e.length-4)}`:""}}},z=a(1241);const R=(0,z.A)(q,[["render",I],["__scopeId","data-v-552b1876"]]);var Y=R;const J={class:"create-listing-modal"},W={class:"create-listing-modal__box"},j={key:0,class:"create-listing-modal__loader-container"},H={key:1,class:"create-listing-modal__empty"},K={key:2},X={class:"create-listing-modal__section"},Z={class:"create-listing-modal__nft-grid"},G=["onClick"],Q={class:"create-listing-modal__nft-image-container"},ee=["src","alt"],te={key:1,class:"create-listing-modal__nft-placeholder"},ae={class:"create-listing-modal__nft-info"},ne={class:"create-listing-modal__nft-name"},ie={class:"create-listing-modal__form"},le={class:"create-listing-modal__form-group"},se={class:"create-listing-modal__form-group"},re={class:"create-listing-modal__form-group"},oe=["min"],ce={class:"create-listing-modal__fee-summary"},de={class:"create-listing-modal__fee-row"},me={class:"create-listing-modal__fee-row create-listing-modal__fee-row--total"},ue={class:"create-listing-modal__button-group"},ge=["disabled"];function _e(e,t,a,i,l,s){return(0,n.openBlock)(),(0,n.createElementBlock)("div",J,[(0,n.createElementVNode)("div",W,[t[19]||(t[19]=(0,n.createElementVNode)("h3",{class:"create-listing-modal__title"},"Create NFT Listing",-1)),a.isLoading?((0,n.openBlock)(),(0,n.createElementBlock)("div",j,t[6]||(t[6]=[(0,n.createElementVNode)("div",{class:"create-listing-modal__loader"},null,-1)]))):0===a.userNfts.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",H,t[7]||(t[7]=[(0,n.createElementVNode)("p",{class:"create-listing-modal__empty-title"},"You don't have any NFTs to list.",-1),(0,n.createElementVNode)("p",{class:"create-listing-modal__empty-subtitle"},"Mint or acquire NFTs first before creating a listing.",-1)]))):((0,n.openBlock)(),(0,n.createElementBlock)("div",K,[(0,n.createElementVNode)("div",X,[t[9]||(t[9]=(0,n.createElementVNode)("label",{class:"create-listing-modal__label"},"Select NFT",-1)),(0,n.createElementVNode)("div",Z,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(a.userNfts,(e=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:e.mintAddress,onClick:t=>s.selectNft(e),class:(0,n.normalizeClass)(["create-listing-modal__nft-item",{"create-listing-modal__nft-item--selected":l.selectedNft&&l.selectedNft.mintAddress===e.mintAddress}])},[(0,n.createElementVNode)("div",Q,[e.imageUrl?((0,n.openBlock)(),(0,n.createElementBlock)("img",{key:0,src:e.imageUrl,alt:e.name,class:"create-listing-modal__nft-image"},null,8,ee)):((0,n.openBlock)(),(0,n.createElementBlock)("div",te,t[8]||(t[8]=[(0,n.createElementVNode)("i",{class:"fas fa-image create-listing-modal__nft-placeholder-icon"},null,-1)])))]),(0,n.createElementVNode)("div",ae,[(0,n.createElementVNode)("p",ne,(0,n.toDisplayString)(e.name||`NFT #${e.mintAddress.substring(0,8)}`),1)])],10,G)))),128))])]),(0,n.createElementVNode)("div",ie,[(0,n.createElementVNode)("div",le,[t[10]||(t[10]=(0,n.createElementVNode)("label",{class:"create-listing-modal__form-label"},[(0,n.createElementVNode)("span",{class:"create-listing-modal__form-label-text"},"Initial Price (SOL)")],-1)),(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.initialPrice=e),type:"number",step:"0.01",min:"0.01",placeholder:"Enter initial price",class:"create-listing-modal__form-input",required:""},null,512),[[n.vModelText,l.form.initialPrice]]),t[11]||(t[11]=(0,n.createElementVNode)("span",{class:"create-listing-modal__form-help"},"Minimum price for the auction",-1))]),(0,n.createElementVNode)("div",se,[t[12]||(t[12]=(0,n.createElementVNode)("label",{class:"create-listing-modal__form-label"},[(0,n.createElementVNode)("span",{class:"create-listing-modal__form-label-text"},"Instant Buy Price (SOL, optional)")],-1)),(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.instantPrice=e),type:"number",step:"0.01",min:"0",placeholder:"Enter instant buy price (optional)",class:"create-listing-modal__form-input"},null,512),[[n.vModelText,l.form.instantPrice]]),t[13]||(t[13]=(0,n.createElementVNode)("span",{class:"create-listing-modal__form-help"},"Price for immediate purchase",-1))]),(0,n.createElementVNode)("div",re,[t[14]||(t[14]=(0,n.createElementVNode)("label",{class:"create-listing-modal__form-label"},[(0,n.createElementVNode)("span",{class:"create-listing-modal__form-label-text"},"End Date")],-1)),(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.form.endDate=e),type:"datetime-local",class:"create-listing-modal__form-input",required:"",min:s.minEndDate},null,8,oe),[[n.vModelText,l.form.endDate]]),t[15]||(t[15]=(0,n.createElementVNode)("span",{class:"create-listing-modal__form-help"},"When the auction will end",-1))]),(0,n.createElementVNode)("div",ce,[t[18]||(t[18]=(0,n.createElementVNode)("h4",{class:"create-listing-modal__fee-title"},"Fees",-1)),(0,n.createElementVNode)("div",de,[t[16]||(t[16]=(0,n.createElementVNode)("span",null,"Marketplace Fee (5%)",-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(s.calculateFee())+" SOL",1)]),(0,n.createElementVNode)("div",me,[t[17]||(t[17]=(0,n.createElementVNode)("span",null,"You will receive",-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(s.calculateReceived())+" SOL",1)])]),(0,n.createElementVNode)("div",ue,[(0,n.createElementVNode)("button",{type:"button",onClick:t[3]||(t[3]=t=>e.$emit("close")),class:"create-listing-modal__button create-listing-modal__button--cancel"}," Cancel "),(0,n.createElementVNode)("button",{type:"button",onClick:t[4]||(t[4]=(...e)=>s.createListingManually&&s.createListingManually(...e)),class:"create-listing-modal__button create-listing-modal__button--submit",disabled:!s.isFormValid||a.isSubmitting},(0,n.toDisplayString)(a.isSubmitting?"Creating...":"Create Listing"),9,ge)])])]))]),(0,n.createElementVNode)("div",{class:"create-listing-modal__backdrop",onClick:t[5]||(t[5]=t=>e.$emit("close"))})])}var fe=a(4348),pe={name:"CreateListingModal",props:{userNfts:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},data(){return{selectedNft:null,form:{initialPrice:"",instantPrice:"",endDate:""}}},computed:{minEndDate(){const e=new Date;return e.setHours(e.getHours()+1),e.toISOString().slice(0,16)},isFormValid(){return this.selectedNft&&this.form.initialPrice>0&&this.form.endDate&&new Date(this.form.endDate)>new Date}},methods:{selectNft(e){fe.log("Selecting NFT:",e),e&&e.mintAddress?(this.selectedNft=e,fe.log("Selected NFT:",this.selectedNft)):fe.error("Invalid NFT selected:",e)},calculateFee(){if(!this.form.initialPrice)return"0";const e=.05*parseFloat(this.form.initialPrice);return e.toFixed(3)},calculateReceived(){if(!this.form.initialPrice)return"0";const e=parseFloat(this.form.initialPrice),t=.05*e;return(e-t).toFixed(3)},createListingManually(){if(!this.isFormValid)return;fe.log("Creating listing for NFT:",this.selectedNft);const e={mintAddress:this.selectedNft.mintAddress,name:this.selectedNft.name||"",imageUrl:this.selectedNft.imageUrl||"",metadataUri:this.selectedNft.metadataUri||""};fe.log("Sending NFT data to parent:",e),this.$emit("submit",{nft:e,initialPrice:parseFloat(this.form.initialPrice),instantPrice:this.form.instantPrice?parseFloat(this.form.instantPrice):null,endDate:this.form.endDate})}}};const be=(0,z.A)(pe,[["render",_e],["__scopeId","data-v-93970504"]]);var Ne=be,ke=a(6241),ve=a(9710),Ee=a(4348),he=a(712)["Buffer"],ye={name:"NftMarketPage",components:{NftListingCard:Y,CreateListingModal:Ne,PlaceBidModal:ke.A,CancelListingModal:ve.A},setup(){const{wallet:e,connected:t,publicKey:a}=(0,N.vT)(),i=(0,k.useRouter)(),l=(0,n.ref)([]),s=(0,n.ref)([]),r=(0,n.ref)([]),o=(0,n.ref)(null),c=(0,n.ref)(!1),d=(0,n.ref)(!1),m=(0,n.ref)(!1),u=(0,n.ref)(!1),g=(0,n.ref)(!1),_=(0,n.ref)("all"),f=(0,n.ref)(!1),p=(0,n.ref)(!1),b=(0,n.ref)(!1),v=(0,n.computed)((()=>a.value?a.value.toString():"")),y=(0,n.computed)((()=>"my"===_.value?s.value:l.value)),V=async()=>{try{c.value=!0;const e=await E().get("/nft-market/listings");l.value=e.data.data}catch(e){Ee.error("Error loading listings:",e)}finally{c.value=!1}},B=async()=>{if(t.value)try{const e=await E().get("/nft-market/listings/my");s.value=e.data.data}catch(e){Ee.error("Error loading my listings:",e)}},w=async()=>{if(t.value)try{d.value=!0;const e=await E().get("/nft-market/my-nfts");r.value=e.data.data}catch(e){Ee.error("Error loading user NFTs:",e),r.value=[]}finally{d.value=!1}},C=e=>{i.push(`/nft-market/listing/${e.mintAddress}`)},L=e=>{o.value=e,p.value=!0},F=e=>{o.value=e,b.value=!0},P=async e=>{try{if(m.value=!0,e.isTrusted){const t={nft:r.value[0],initialPrice:.1,instantPrice:.2,endDate:new Date(Date.now()+864e5).toISOString().slice(0,16)};Ee.log("Using fallback NFT data:",t),e=t}if(Ee.log("Creating listing for NFT:",JSON.stringify(e,null,2)),!e.nft||!e.nft.mintAddress)return Ee.error("Missing NFT data or mintAddress:",e),alert("Invalid NFT data. Please select an NFT and try again."),void(m.value=!1);Ee.log("Requesting listing instructions for:",e.nft.mintAddress);const a=await E().post("/nft-market/listing-instructions",{mintAddress:e.nft.mintAddress,initialPrice:e.initialPrice});if(Ee.log("Instructions response:",JSON.stringify(a.data,null,2)),!a.data.success)return Ee.error("Error getting listing instructions:",a.data),alert("Failed to get listing instructions. Please try again."),void(m.value=!1);const n=a.data.data;if(Ee.log("Instructions data:",JSON.stringify(n,null,2)),!n.serializedTransaction)return Ee.error("Missing serializedTransaction in instructions:",n),alert("Failed to get transaction data. Please try again."),void(m.value=!1);try{const t=window.solana;if(!t)throw new Error("Phantom wallet not found");const{ZX:a}=h,i=new h.Ng("https://sleek-icy-frog.solana-mainnet.quiknode.pro/9d4845e2d4c60caf45dc4f10d0bdcfdbcd6a321c");Ee.log("Deserializing transaction...");const l=he.from(n.serializedTransaction,"base64"),s=a.from(l);Ee.log("Transaction deserialized successfully:",{recentBlockhash:s.recentBlockhash,feePayer:s.feePayer.toString(),instructions:s.instructions.length}),Ee.log("Requesting signature from Phantom...");const r=await t.signTransaction(s);Ee.log("Transaction signed, sending to network...");const o=await i.sendRawTransaction(r.serialize());Ee.log("Transaction sent with signature:",o),Ee.log("Waiting for transaction confirmation...");const c=await i.confirmTransaction(o);if(Ee.log("Transaction confirmation response:",c),c.value&&c.value.err)throw new Error(`Transaction failed: ${JSON.stringify(c.value.err)}`);Ee.log("Transaction confirmed:",o),Ee.log("Creating listing in database..."),Ee.log("Data for createListing:",{mintAddress:e.nft.mintAddress,initialPrice:e.initialPrice,instantPrice:e.instantPrice,endTime:new Date(e.endDate).toISOString(),transactionSignature:o});const d=await E().post("/nft-market/listings",{mintAddress:e.nft.mintAddress,initialPrice:e.initialPrice,instantPrice:e.instantPrice,endTime:new Date(e.endDate).toISOString(),transactionSignature:o});d.data.success?(Ee.log("Listing created successfully:",d.data),f.value=!1,await V(),await B()):(Ee.error("Error creating listing:",d.data),alert("Failed to create listing. Please try again."))}catch(t){Ee.error("Error signing or sending transaction:",t),alert("Failed to sign transaction. Please try again: "+(t.message||"Unknown error"))}}catch(a){Ee.error("Error creating listing:",a),alert("Failed to create listing. Please try again: "+(a.message||"Unknown error"))}finally{m.value=!1}},A=async e=>{try{u.value=!0;await E().post("/nft-market/bid",{mintAddress:e.mintAddress,bidAmount:e.amount});p.value=!1,o.value=null,await V(),await B()}catch(t){Ee.error("Error placing bid:",t),alert("Failed to place bid. Please try again.")}finally{u.value=!1}},S=async()=>{try{g.value=!0;await E().post("/nft-market/listings/cancel",{mintAddress:o.value.mintAddress});b.value=!1,o.value=null,await V(),await B()}catch(e){Ee.error("Error cancelling listing:",e),alert("Failed to cancel listing. Please try again.")}finally{g.value=!1}};return(0,n.onMounted)((async()=>{await V()})),(0,n.watch)(t,(async e=>{e?await B():(s.value=[],_.value="all")})),(0,n.watch)(f,(async e=>{e&&await w()})),{wallet:e,connected:t,walletAddress:v,listings:l,myListings:s,userNfts:r,selectedListing:o,isLoading:c,isLoadingUserNfts:d,isCreatingListing:m,isPlacingBid:u,isCancelling:g,activeTab:_,showCreateListingModal:f,showBidModal:p,showCancelModal:b,displayedListings:y,loadListings:V,loadMyListings:B,loadUserNfts:w,viewListing:C,placeBid:L,cancelListing:F,handleCreateListing:P,handlePlaceBid:A,handleCancelListing:S}}};const Ve=(0,z.A)(ye,[["render",b],["__scopeId","data-v-60f9191b"]]);var Be=Ve}}]);
//# sourceMappingURL=152.eca1e32e.js.map