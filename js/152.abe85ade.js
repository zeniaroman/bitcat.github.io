"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[152],{9710:function(t,i,e){e.d(i,{A:function(){return g}});var a=e(6768);const n={class:"cancel-modal"},s={class:"cancel-modal__box"},l={class:"cancel-modal__actions"},r=["disabled"],o={key:0,class:"cancel-modal__spinner"};function c(t,i,e,c,d,u){return(0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",s,[i[4]||(i[4]=(0,a.Lk)("h3",{class:"cancel-modal__title"},"Cancel Listing",-1)),i[5]||(i[5]=(0,a.Lk)("p",{class:"cancel-modal__message"},"Are you sure you want to cancel this listing?",-1)),(0,a.Lk)("div",l,[(0,a.Lk)("button",{type:"button",class:"cancel-modal__button cancel-modal__button--secondary",onClick:i[0]||(i[0]=i=>t.$emit("close"))}," No, Keep Listing "),(0,a.Lk)("button",{onClick:i[1]||(i[1]=i=>t.$emit("confirm")),class:"cancel-modal__button cancel-modal__button--danger",disabled:e.isSubmitting},[e.isSubmitting?((0,a.uX)(),(0,a.CE)("span",o)):(0,a.Q3)("",!0),i[3]||(i[3]=(0,a.eW)(" Yes, Cancel Listing "))],8,r)])]),(0,a.Lk)("div",{class:"cancel-modal__backdrop",onClick:i[2]||(i[2]=i=>t.$emit("close"))})])}var d={name:"CancelListingModal",props:{isSubmitting:{type:Boolean,default:!1}}},u=e(1241);const m=(0,u.A)(d,[["render",c],["__scopeId","data-v-f36f194a"]]);var g=m},6241:function(t,i,e){e.d(i,{A:function(){return N}});var a=e(6768),n=e(4232),s=e(5130);const l={class:"bid-modal"},r={class:"bid-modal__box"},o={class:"bid-modal__nft-preview"},c={class:"bid-modal__nft-image-container"},d=["src","alt"],u={key:1,class:"bid-modal__nft-placeholder"},m={class:"bid-modal__nft-name"},g={class:"bid-modal__form-group"},_=["value"],f={class:"bid-modal__form-group"},k=["min"],b={class:"bid-modal__form-help"},p={class:"bid-modal__fee-summary"},L={class:"bid-modal__fee-row"},v={class:"bid-modal__fee-row bid-modal__fee-row--total"},h={class:"bid-modal__actions"},y=["disabled"],C={key:0,class:"bid-modal__spinner"};function w(t,i,e,w,A,F){return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",r,[i[11]||(i[11]=(0,a.Lk)("h3",{class:"bid-modal__title"},"Place Bid",-1)),(0,a.Lk)("div",o,[(0,a.Lk)("div",c,[e.listing.imageUrl?((0,a.uX)(),(0,a.CE)("img",{key:0,src:e.listing.imageUrl,alt:e.listing.name,class:"bid-modal__nft-image"},null,8,d)):((0,a.uX)(),(0,a.CE)("div",u,i[4]||(i[4]=[(0,a.Lk)("i",{class:"fas fa-image bid-modal__nft-placeholder-icon"},null,-1)])))]),(0,a.Lk)("h4",m,(0,n.v_)(e.listing.name||`NFT #${e.listing.mintAddress.substring(0,8)}`),1)]),(0,a.Lk)("form",{onSubmit:i[2]||(i[2]=(0,s.D$)(((...t)=>F.submitBid&&F.submitBid(...t)),["prevent"])),class:"bid-modal__form"},[(0,a.Lk)("div",g,[i[5]||(i[5]=(0,a.Lk)("label",{class:"bid-modal__form-label"},[(0,a.Lk)("span",{class:"bid-modal__form-label-text"},"Current Price")],-1)),(0,a.Lk)("input",{value:F.formatPrice(e.listing.highestBid||e.listing.initialPrice),type:"text",class:"bid-modal__form-input bid-modal__form-input--disabled",disabled:""},null,8,_)]),(0,a.Lk)("div",f,[i[6]||(i[6]=(0,a.Lk)("label",{class:"bid-modal__form-label"},[(0,a.Lk)("span",{class:"bid-modal__form-label-text"},"Your Bid (SOL)")],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>A.bidAmount=t),type:"number",step:"0.01",min:F.minBidAmount,placeholder:"Enter bid amount",class:"bid-modal__form-input",required:""},null,8,k),[[s.Jo,A.bidAmount]]),(0,a.Lk)("span",b,"Minimum bid: "+(0,n.v_)(F.minBidAmount)+" SOL",1)]),(0,a.Lk)("div",p,[i[9]||(i[9]=(0,a.Lk)("h4",{class:"bid-modal__fee-title"},"Fees",-1)),(0,a.Lk)("div",L,[i[7]||(i[7]=(0,a.Lk)("span",null,"Marketplace Fee (5%)",-1)),(0,a.Lk)("span",null,(0,n.v_)(F.calculateFee())+" SOL",1)]),(0,a.Lk)("div",v,[i[8]||(i[8]=(0,a.Lk)("span",null,"Total",-1)),(0,a.Lk)("span",null,(0,n.v_)(F.calculateTotal())+" SOL",1)])]),(0,a.Lk)("div",h,[(0,a.Lk)("button",{type:"button",class:"bid-modal__button bid-modal__button--cancel",onClick:i[1]||(i[1]=i=>t.$emit("close"))},"Cancel"),(0,a.Lk)("button",{type:"submit",class:"bid-modal__button bid-modal__button--submit",disabled:e.isSubmitting||!F.isFormValid},[e.isSubmitting?((0,a.uX)(),(0,a.CE)("span",C)):(0,a.Q3)("",!0),i[10]||(i[10]=(0,a.eW)(" Place Bid "))],8,y)])],32)]),(0,a.Lk)("div",{class:"bid-modal__backdrop",onClick:i[3]||(i[3]=i=>t.$emit("close"))})])}var A={name:"PlaceBidModal",props:{listing:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1}},data(){return{bidAmount:""}},computed:{minBidAmount(){const t=this.listing.highestBid||this.listing.initialPrice;return(parseFloat(t)+.01).toFixed(2)},isFormValid(){return this.bidAmount&&parseFloat(this.bidAmount)>=parseFloat(this.minBidAmount)}},methods:{formatPrice(t){return parseFloat(t).toFixed(3)},calculateFee(){if(!this.bidAmount)return"0";const t=.05*parseFloat(this.bidAmount);return t.toFixed(3)},calculateTotal(){if(!this.bidAmount)return"0";const t=parseFloat(this.bidAmount),i=.05*t;return(t+i).toFixed(3)},submitBid(){this.isFormValid&&this.$emit("submit",{mintAddress:this.listing.mintAddress,amount:parseFloat(this.bidAmount)})}},mounted(){this.bidAmount=this.minBidAmount}},F=e(1241);const P=(0,F.A)(A,[["render",w],["__scopeId","data-v-fe5ce5c6"]]);var N=P},8152:function(t,i,e){e.r(i),e.d(i,{default:function(){return Pt}});var a=e(6768),n=e(4232);const s={class:"nft-market"},l={class:"nft-market__container"},r={key:0,class:"nft-market__create-section"},o={class:"nft-market__listings-section"},c={class:"nft-market__listings-header"},d={class:"nft-market__listings-controls"},u=["disabled"],m={key:0,class:"nft-market__tab-buttons"},g={key:0,class:"nft-market__loader-container"},_={key:1,class:"nft-market__empty-state"},f={key:0,class:"nft-market__empty-subtitle"},k={key:1,class:"nft-market__empty-subtitle"},b={key:2,class:"nft-market__listings-grid"};function p(t,i,e,p,L,v){const h=(0,a.g2)("NftListingCard"),y=(0,a.g2)("CreateListingModal"),C=(0,a.g2)("PlaceBidModal"),w=(0,a.g2)("CancelListingModal");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",l,[i[13]||(i[13]=(0,a.Lk)("h1",{class:"nft-market__title"},"NFT Marketplace",-1)),p.wallet&&p.connected?((0,a.uX)(),(0,a.CE)("div",r,[i[7]||(i[7]=(0,a.Lk)("h2",{class:"nft-market__section-title"},"Sell Your NFT",-1)),i[8]||(i[8]=(0,a.Lk)("p",{class:"nft-market__section-description"},"List your NFT for sale on our marketplace and earn SOL.",-1)),(0,a.Lk)("button",{onClick:i[0]||(i[0]=t=>p.showCreateListingModal=!0),class:"nft-market__create-button"}," Create Listing ")])):(0,a.Q3)("",!0),(0,a.Lk)("div",o,[(0,a.Lk)("div",c,[i[10]||(i[10]=(0,a.Lk)("h2",{class:"nft-market__section-title"},"Active Listings",-1)),(0,a.Lk)("div",d,[(0,a.Lk)("button",{onClick:i[1]||(i[1]=(...t)=>p.loadListings&&p.loadListings(...t)),class:"nft-market__refresh-button",disabled:p.isLoading},i[9]||(i[9]=[(0,a.Lk)("i",{class:"fas fa-sync-alt nft-market__refresh-icon"},null,-1),(0,a.eW)(" Refresh ")]),8,u),p.wallet&&p.connected?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("button",{onClick:i[2]||(i[2]=t=>p.activeTab="all"),class:(0,n.C4)(["nft-market__tab-button",{"nft-market__tab-button--active":"all"===p.activeTab}])}," All ",2),(0,a.Lk)("button",{onClick:i[3]||(i[3]=t=>p.activeTab="my"),class:(0,n.C4)(["nft-market__tab-button",{"nft-market__tab-button--active":"my"===p.activeTab}])}," My Listings ",2)])):(0,a.Q3)("",!0)])]),p.isLoading?((0,a.uX)(),(0,a.CE)("div",g,i[11]||(i[11]=[(0,a.Lk)("div",{class:"nft-market__loader"},null,-1)]))):0===p.displayedListings.length?((0,a.uX)(),(0,a.CE)("div",_,[i[12]||(i[12]=(0,a.Lk)("p",{class:"nft-market__empty-title"},"No NFT listings found.",-1)),"my"===p.activeTab?((0,a.uX)(),(0,a.CE)("p",f," You haven't listed any NFTs for sale yet. ")):((0,a.uX)(),(0,a.CE)("p",k," Be the first to list your NFT on our marketplace! "))])):((0,a.uX)(),(0,a.CE)("div",b,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(p.displayedListings,(t=>((0,a.uX)(),(0,a.Wv)(h,{key:t.id,listing:t,"wallet-address":p.walletAddress,connected:p.connected,onView:p.viewListing,onBid:p.placeBid,onCancel:p.cancelListing},null,8,["listing","wallet-address","connected","onView","onBid","onCancel"])))),128))]))])]),p.showCreateListingModal?((0,a.uX)(),(0,a.Wv)(y,{key:0,"user-nfts":p.userNfts,"is-loading":p.isLoadingUserNfts,"is-submitting":p.isCreatingListing,onClose:i[4]||(i[4]=t=>p.showCreateListingModal=!1),onSubmit:p.handleCreateListing},null,8,["user-nfts","is-loading","is-submitting","onSubmit"])):(0,a.Q3)("",!0),p.showBidModal&&p.selectedListing?((0,a.uX)(),(0,a.Wv)(C,{key:1,listing:p.selectedListing,"is-submitting":p.isPlacingBid,onClose:i[5]||(i[5]=t=>p.showBidModal=!1),onSubmit:p.handlePlaceBid},null,8,["listing","is-submitting","onSubmit"])):(0,a.Q3)("",!0),p.showCancelModal&&p.selectedListing?((0,a.uX)(),(0,a.Wv)(w,{key:2,"is-submitting":p.isCancelling,onClose:i[6]||(i[6]=t=>p.showCancelModal=!1),onConfirm:p.handleCancelListing},null,8,["is-submitting","onConfirm"])):(0,a.Q3)("",!0)])}e(4114);var L=e(144),v=e(5305),h=e(1387),y=e(4373),C=e(6615);const w={class:"nft-card"},A={class:"nft-card__image-container"},F=["src","alt"],P={key:1,class:"nft-card__image-placeholder"},N={class:"nft-card__content"},T={class:"nft-card__title"},E={class:"nft-card__address"},S={key:0,class:"nft-card__seller"},B={class:"nft-card__seller-value"},M={class:"nft-card__price-container"},X={class:"nft-card__price-block"},D={class:"nft-card__price-value"},$={key:0,class:"nft-card__price-block"},O={class:"nft-card__price-value"},R={class:"nft-card__time-block"},U={class:"nft-card__time-value"},x={class:"nft-card__actions"};function I(t,i,e,s,l,r){return(0,a.uX)(),(0,a.CE)("div",w,[(0,a.Lk)("div",A,[e.listing.imageUrl?((0,a.uX)(),(0,a.CE)("img",{key:0,src:e.listing.imageUrl,alt:e.listing.name,class:"nft-card__image"},null,8,F)):((0,a.uX)(),(0,a.CE)("div",P,i[3]||(i[3]=[(0,a.Lk)("i",{class:"fas fa-image nft-card__placeholder-icon"},null,-1)]))),"active"!==e.listing.status?((0,a.uX)(),(0,a.CE)("div",{key:2,class:(0,n.C4)(["nft-card__status",{"nft-card__status--sold":"sold"===e.listing.status,"nft-card__status--cancelled":"cancelled"===e.listing.status,"nft-card__status--expired":"expired"===e.listing.status}])},(0,n.v_)(e.listing.status),3)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",N,[(0,a.Lk)("h3",T,(0,n.v_)(e.listing.name||`NFT #${e.listing.mintAddress.substring(0,8)}`),1),(0,a.Lk)("p",E,(0,n.v_)(r.shortenAddress(e.listing.mintAddress)),1),e.listing.userTag?((0,a.uX)(),(0,a.CE)("div",S,[i[4]||(i[4]=(0,a.Lk)("p",{class:"nft-card__seller-label"},"Seller:",-1)),(0,a.Lk)("p",B,(0,n.v_)(e.listing.userTag),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",M,[(0,a.Lk)("div",X,[i[5]||(i[5]=(0,a.Lk)("p",{class:"nft-card__price-label"},"Price",-1)),(0,a.Lk)("p",D,(0,n.v_)(r.formatPrice(e.listing.initialPrice))+" SOL",1)]),e.listing.instantPrice?((0,a.uX)(),(0,a.CE)("div",$,[i[6]||(i[6]=(0,a.Lk)("p",{class:"nft-card__price-label"},"Buy Now",-1)),(0,a.Lk)("p",O,(0,n.v_)(r.formatPrice(e.listing.instantPrice))+" SOL",1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",R,[i[7]||(i[7]=(0,a.Lk)("p",{class:"nft-card__time-label"},"Ends in",-1)),(0,a.Lk)("p",U,(0,n.v_)(r.formatTimeRemaining(e.listing.endTime)),1)]),(0,a.Lk)("div",x,[(0,a.Lk)("button",{onClick:i[0]||(i[0]=i=>t.$emit("view",e.listing)),class:"nft-card__button nft-card__button--view"}," View Details "),r.canBid?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:i[1]||(i[1]=i=>t.$emit("bid",e.listing)),class:"nft-card__button nft-card__button--bid"}," Place Bid ")):(0,a.Q3)("",!0),r.canCancel?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:i[2]||(i[2]=i=>t.$emit("cancel",e.listing)),class:"nft-card__button nft-card__button--cancel"}," Cancel ")):(0,a.Q3)("",!0)])])])}var K={name:"NftListingCard",props:{listing:{type:Object,required:!0},walletAddress:{type:String,default:""},connected:{type:Boolean,default:!1}},computed:{canBid(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet!==this.walletAddress},canCancel(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet===this.walletAddress}},methods:{formatPrice(t){return parseFloat(t).toFixed(3)},formatTimeRemaining(t){const i=new Date(t),e=new Date;if(i<=e)return"Ended";const a=i-e,n=Math.floor(a/864e5),s=Math.floor(a%864e5/36e5),l=Math.floor(a%36e5/6e4);return n>0?`${n}d ${s}h`:s>0?`${s}h ${l}m`:`${l}m`},shortenAddress(t){return t?`${t.substring(0,4)}...${t.substring(t.length-4)}`:""}}},V=e(1241);const W=(0,V.A)(K,[["render",I],["__scopeId","data-v-552b1876"]]);var Q=W,q=e(5130);const J={class:"create-listing-modal"},z={class:"create-listing-modal__box"},Y={key:0,class:"create-listing-modal__loader-container"},j={key:1,class:"create-listing-modal__empty"},H={key:2},Z={class:"create-listing-modal__section"},G={class:"create-listing-modal__nft-grid"},tt=["onClick"],it={class:"create-listing-modal__nft-image-container"},et=["src","alt"],at={key:1,class:"create-listing-modal__nft-placeholder"},nt={class:"create-listing-modal__nft-info"},st={class:"create-listing-modal__nft-name"},lt={class:"create-listing-modal__form"},rt={class:"create-listing-modal__form-group"},ot={class:"create-listing-modal__form-group"},ct={class:"create-listing-modal__form-group"},dt=["min"],ut={class:"create-listing-modal__fee-summary"},mt={class:"create-listing-modal__fee-row"},gt={class:"create-listing-modal__fee-row create-listing-modal__fee-row--total"},_t={class:"create-listing-modal__button-group"},ft=["disabled"];function kt(t,i,e,s,l,r){return(0,a.uX)(),(0,a.CE)("div",J,[(0,a.Lk)("div",z,[i[19]||(i[19]=(0,a.Lk)("h3",{class:"create-listing-modal__title"},"Create NFT Listing",-1)),e.isLoading?((0,a.uX)(),(0,a.CE)("div",Y,i[6]||(i[6]=[(0,a.Lk)("div",{class:"create-listing-modal__loader"},null,-1)]))):0===e.userNfts.length?((0,a.uX)(),(0,a.CE)("div",j,i[7]||(i[7]=[(0,a.Lk)("p",{class:"create-listing-modal__empty-title"},"You don't have any NFTs to list.",-1),(0,a.Lk)("p",{class:"create-listing-modal__empty-subtitle"},"Mint or acquire NFTs first before creating a listing.",-1)]))):((0,a.uX)(),(0,a.CE)("div",H,[(0,a.Lk)("div",Z,[i[9]||(i[9]=(0,a.Lk)("label",{class:"create-listing-modal__label"},"Select NFT",-1)),(0,a.Lk)("div",G,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.userNfts,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.mintAddress,onClick:i=>r.selectNft(t),class:(0,n.C4)(["create-listing-modal__nft-item",{"create-listing-modal__nft-item--selected":l.selectedNft&&l.selectedNft.mintAddress===t.mintAddress}])},[(0,a.Lk)("div",it,[t.imageUrl?((0,a.uX)(),(0,a.CE)("img",{key:0,src:t.imageUrl,alt:t.name,class:"create-listing-modal__nft-image"},null,8,et)):((0,a.uX)(),(0,a.CE)("div",at,i[8]||(i[8]=[(0,a.Lk)("i",{class:"fas fa-image create-listing-modal__nft-placeholder-icon"},null,-1)])))]),(0,a.Lk)("div",nt,[(0,a.Lk)("p",st,(0,n.v_)(t.name||`NFT #${t.mintAddress.substring(0,8)}`),1)])],10,tt)))),128))])]),(0,a.Lk)("div",lt,[(0,a.Lk)("div",rt,[i[10]||(i[10]=(0,a.Lk)("label",{class:"create-listing-modal__form-label"},[(0,a.Lk)("span",{class:"create-listing-modal__form-label-text"},"Initial Price (SOL)")],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>l.form.initialPrice=t),type:"number",step:"0.01",min:"0.01",placeholder:"Enter initial price",class:"create-listing-modal__form-input",required:""},null,512),[[q.Jo,l.form.initialPrice]]),i[11]||(i[11]=(0,a.Lk)("span",{class:"create-listing-modal__form-help"},"Minimum price for the auction",-1))]),(0,a.Lk)("div",ot,[i[12]||(i[12]=(0,a.Lk)("label",{class:"create-listing-modal__form-label"},[(0,a.Lk)("span",{class:"create-listing-modal__form-label-text"},"Instant Buy Price (SOL, optional)")],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":i[1]||(i[1]=t=>l.form.instantPrice=t),type:"number",step:"0.01",min:"0",placeholder:"Enter instant buy price (optional)",class:"create-listing-modal__form-input"},null,512),[[q.Jo,l.form.instantPrice]]),i[13]||(i[13]=(0,a.Lk)("span",{class:"create-listing-modal__form-help"},"Price for immediate purchase",-1))]),(0,a.Lk)("div",ct,[i[14]||(i[14]=(0,a.Lk)("label",{class:"create-listing-modal__form-label"},[(0,a.Lk)("span",{class:"create-listing-modal__form-label-text"},"End Date")],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":i[2]||(i[2]=t=>l.form.endDate=t),type:"datetime-local",class:"create-listing-modal__form-input",required:"",min:r.minEndDate},null,8,dt),[[q.Jo,l.form.endDate]]),i[15]||(i[15]=(0,a.Lk)("span",{class:"create-listing-modal__form-help"},"When the auction will end",-1))]),(0,a.Lk)("div",ut,[i[18]||(i[18]=(0,a.Lk)("h4",{class:"create-listing-modal__fee-title"},"Fees",-1)),(0,a.Lk)("div",mt,[i[16]||(i[16]=(0,a.Lk)("span",null,"Marketplace Fee (5%)",-1)),(0,a.Lk)("span",null,(0,n.v_)(r.calculateFee())+" SOL",1)]),(0,a.Lk)("div",gt,[i[17]||(i[17]=(0,a.Lk)("span",null,"You will receive",-1)),(0,a.Lk)("span",null,(0,n.v_)(r.calculateReceived())+" SOL",1)])]),(0,a.Lk)("div",_t,[(0,a.Lk)("button",{type:"button",onClick:i[3]||(i[3]=i=>t.$emit("close")),class:"create-listing-modal__button create-listing-modal__button--cancel"}," Cancel "),(0,a.Lk)("button",{type:"button",onClick:i[4]||(i[4]=(...t)=>r.createListingManually&&r.createListingManually(...t)),class:"create-listing-modal__button create-listing-modal__button--submit",disabled:!r.isFormValid||e.isSubmitting},(0,n.v_)(e.isSubmitting?"Creating...":"Create Listing"),9,ft)])])]))]),(0,a.Lk)("div",{class:"create-listing-modal__backdrop",onClick:i[5]||(i[5]=i=>t.$emit("close"))})])}var bt=e(4348),pt={name:"CreateListingModal",props:{userNfts:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},data(){return{selectedNft:null,form:{initialPrice:"",instantPrice:"",endDate:""}}},computed:{minEndDate(){const t=new Date;return t.setHours(t.getHours()+1),t.toISOString().slice(0,16)},isFormValid(){return this.selectedNft&&this.form.initialPrice>0&&this.form.endDate&&new Date(this.form.endDate)>new Date}},methods:{selectNft(t){bt.log("Selecting NFT:",t),t&&t.mintAddress?(this.selectedNft=t,bt.log("Selected NFT:",this.selectedNft)):bt.error("Invalid NFT selected:",t)},calculateFee(){if(!this.form.initialPrice)return"0";const t=.05*parseFloat(this.form.initialPrice);return t.toFixed(3)},calculateReceived(){if(!this.form.initialPrice)return"0";const t=parseFloat(this.form.initialPrice),i=.05*t;return(t-i).toFixed(3)},createListingManually(){if(!this.isFormValid)return;bt.log("Creating listing for NFT:",this.selectedNft);const t={mintAddress:this.selectedNft.mintAddress,name:this.selectedNft.name||"",imageUrl:this.selectedNft.imageUrl||"",metadataUri:this.selectedNft.metadataUri||""};bt.log("Sending NFT data to parent:",t),this.$emit("submit",{nft:t,initialPrice:parseFloat(this.form.initialPrice),instantPrice:this.form.instantPrice?parseFloat(this.form.instantPrice):null,endDate:this.form.endDate})}}};const Lt=(0,V.A)(pt,[["render",kt],["__scopeId","data-v-93970504"]]);var vt=Lt,ht=e(6241),yt=e(9710),Ct=e(4348),wt=e(712)["Buffer"],At={name:"NftMarketPage",components:{NftListingCard:Q,CreateListingModal:vt,PlaceBidModal:ht.A,CancelListingModal:yt.A},setup(){const{wallet:t,connected:i,publicKey:e}=(0,v.vT)(),n=(0,h.rd)(),s=(0,L.KR)([]),l=(0,L.KR)([]),r=(0,L.KR)([]),o=(0,L.KR)(null),c=(0,L.KR)(!1),d=(0,L.KR)(!1),u=(0,L.KR)(!1),m=(0,L.KR)(!1),g=(0,L.KR)(!1),_=(0,L.KR)("all"),f=(0,L.KR)(!1),k=(0,L.KR)(!1),b=(0,L.KR)(!1),p=(0,a.EW)((()=>e.value?e.value.toString():"")),w=(0,a.EW)((()=>"my"===_.value?l.value:s.value)),A=async()=>{try{c.value=!0;const t=await y.A.get("/nft-market/listings");s.value=t.data.data}catch(t){Ct.error("Error loading listings:",t)}finally{c.value=!1}},F=async()=>{if(i.value)try{const t=await y.A.get("/nft-market/listings/my");l.value=t.data.data}catch(t){Ct.error("Error loading my listings:",t)}},P=async()=>{if(i.value)try{d.value=!0;const t=await y.A.get("/nft-market/my-nfts");r.value=t.data.data}catch(t){Ct.error("Error loading user NFTs:",t),r.value=[]}finally{d.value=!1}},N=t=>{n.push(`/nft-market/listing/${t.mintAddress}`)},T=t=>{o.value=t,k.value=!0},E=t=>{o.value=t,b.value=!0},S=async t=>{try{if(u.value=!0,t.isTrusted){const i={nft:r.value[0],initialPrice:.1,instantPrice:.2,endDate:new Date(Date.now()+864e5).toISOString().slice(0,16)};Ct.log("Using fallback NFT data:",i),t=i}if(Ct.log("Creating listing for NFT:",JSON.stringify(t,null,2)),!t.nft||!t.nft.mintAddress)return Ct.error("Missing NFT data or mintAddress:",t),alert("Invalid NFT data. Please select an NFT and try again."),void(u.value=!1);Ct.log("Requesting listing instructions for:",t.nft.mintAddress);const e=await y.A.post("/nft-market/listing-instructions",{mintAddress:t.nft.mintAddress,initialPrice:t.initialPrice});if(Ct.log("Instructions response:",JSON.stringify(e.data,null,2)),!e.data.success)return Ct.error("Error getting listing instructions:",e.data),alert("Failed to get listing instructions. Please try again."),void(u.value=!1);const a=e.data.data;if(Ct.log("Instructions data:",JSON.stringify(a,null,2)),!a.serializedTransaction)return Ct.error("Missing serializedTransaction in instructions:",a),alert("Failed to get transaction data. Please try again."),void(u.value=!1);try{const i=window.solana;if(!i)throw new Error("Phantom wallet not found");const{ZX:e}=C,n=new C.Ng("https://sleek-icy-frog.solana-mainnet.quiknode.pro/9d4845e2d4c60caf45dc4f10d0bdcfdbcd6a321c");Ct.log("Deserializing transaction...");const s=wt.from(a.serializedTransaction,"base64"),l=e.from(s);Ct.log("Transaction deserialized successfully:",{recentBlockhash:l.recentBlockhash,feePayer:l.feePayer.toString(),instructions:l.instructions.length}),Ct.log("Requesting signature from Phantom...");const r=await i.signTransaction(l);Ct.log("Transaction signed, sending to network...");const o=await n.sendRawTransaction(r.serialize());Ct.log("Transaction sent with signature:",o),Ct.log("Waiting for transaction confirmation...");const c=await n.confirmTransaction(o);if(Ct.log("Transaction confirmation response:",c),c.value&&c.value.err)throw new Error(`Transaction failed: ${JSON.stringify(c.value.err)}`);Ct.log("Transaction confirmed:",o),Ct.log("Creating listing in database..."),Ct.log("Data for createListing:",{mintAddress:t.nft.mintAddress,initialPrice:t.initialPrice,instantPrice:t.instantPrice,endTime:new Date(t.endDate).toISOString(),transactionSignature:o});const d=await y.A.post("/nft-market/listings",{mintAddress:t.nft.mintAddress,initialPrice:t.initialPrice,instantPrice:t.instantPrice,endTime:new Date(t.endDate).toISOString(),transactionSignature:o});d.data.success?(Ct.log("Listing created successfully:",d.data),f.value=!1,await A(),await F()):(Ct.error("Error creating listing:",d.data),alert("Failed to create listing. Please try again."))}catch(i){Ct.error("Error signing or sending transaction:",i),alert("Failed to sign transaction. Please try again: "+(i.message||"Unknown error"))}}catch(e){Ct.error("Error creating listing:",e),alert("Failed to create listing. Please try again: "+(e.message||"Unknown error"))}finally{u.value=!1}},B=async t=>{try{m.value=!0;await y.A.post("/nft-market/bid",{mintAddress:t.mintAddress,bidAmount:t.amount});k.value=!1,o.value=null,await A(),await F()}catch(i){Ct.error("Error placing bid:",i),alert("Failed to place bid. Please try again.")}finally{m.value=!1}},M=async()=>{try{g.value=!0;await y.A.post("/nft-market/listings/cancel",{mintAddress:o.value.mintAddress});b.value=!1,o.value=null,await A(),await F()}catch(t){Ct.error("Error cancelling listing:",t),alert("Failed to cancel listing. Please try again.")}finally{g.value=!1}};return(0,a.sV)((async()=>{await A()})),(0,a.wB)(i,(async t=>{t?await F():(l.value=[],_.value="all")})),(0,a.wB)(f,(async t=>{t&&await P()})),{wallet:t,connected:i,walletAddress:p,listings:s,myListings:l,userNfts:r,selectedListing:o,isLoading:c,isLoadingUserNfts:d,isCreatingListing:u,isPlacingBid:m,isCancelling:g,activeTab:_,showCreateListingModal:f,showBidModal:k,showCancelModal:b,displayedListings:w,loadListings:A,loadMyListings:F,loadUserNfts:P,viewListing:N,placeBid:T,cancelListing:E,handleCreateListing:S,handlePlaceBid:B,handleCancelListing:M}}};const Ft=(0,V.A)(At,[["render",p],["__scopeId","data-v-60f9191b"]]);var Pt=Ft}}]);
//# sourceMappingURL=152.abe85ade.js.map