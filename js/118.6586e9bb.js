"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[118],{9710:function(e,t,l){l.d(t,{A:function(){return g}});var i=l(4061);const a={class:"cancel-modal"},n={class:"cancel-modal__box"},s={class:"cancel-modal__actions"},o=["disabled"],d={key:0,class:"cancel-modal__spinner"};function c(e,t,l,c,r,m){return(0,i.openBlock)(),(0,i.createElementBlock)("div",a,[(0,i.createElementVNode)("div",n,[t[4]||(t[4]=(0,i.createElementVNode)("h3",{class:"cancel-modal__title"},"Cancel Listing",-1)),t[5]||(t[5]=(0,i.createElementVNode)("p",{class:"cancel-modal__message"},"Are you sure you want to cancel this listing?",-1)),(0,i.createElementVNode)("div",s,[(0,i.createElementVNode)("button",{type:"button",class:"cancel-modal__button cancel-modal__button--secondary",onClick:t[0]||(t[0]=t=>e.$emit("close"))}," No, Keep Listing "),(0,i.createElementVNode)("button",{onClick:t[1]||(t[1]=t=>e.$emit("confirm")),class:"cancel-modal__button cancel-modal__button--danger",disabled:l.isSubmitting},[l.isSubmitting?((0,i.openBlock)(),(0,i.createElementBlock)("span",d)):(0,i.createCommentVNode)("",!0),t[3]||(t[3]=(0,i.createTextVNode)(" Yes, Cancel Listing "))],8,o)])]),(0,i.createElementVNode)("div",{class:"cancel-modal__backdrop",onClick:t[2]||(t[2]=t=>e.$emit("close"))})])}var r={name:"CancelListingModal",props:{isSubmitting:{type:Boolean,default:!1}}},m=l(1241);const u=(0,m.A)(r,[["render",c],["__scopeId","data-v-f36f194a"]]);var g=u},6241:function(e,t,l){l.d(t,{A:function(){return C}});var i=l(4061);const a={class:"bid-modal"},n={class:"bid-modal__box"},s={class:"bid-modal__nft-preview"},o={class:"bid-modal__nft-image-container"},d=["src","alt"],c={key:1,class:"bid-modal__nft-placeholder"},r={class:"bid-modal__nft-name"},m={class:"bid-modal__form-group"},u=["value"],g={class:"bid-modal__form-group"},_=["min"],p={class:"bid-modal__form-help"},b={class:"bid-modal__fee-summary"},v={class:"bid-modal__fee-row"},N={class:"bid-modal__fee-row bid-modal__fee-row--total"},k={class:"bid-modal__actions"},E=["disabled"],V={key:0,class:"bid-modal__spinner"};function f(e,t,l,f,h,B){return(0,i.openBlock)(),(0,i.createElementBlock)("div",a,[(0,i.createElementVNode)("div",n,[t[11]||(t[11]=(0,i.createElementVNode)("h3",{class:"bid-modal__title"},"Place Bid",-1)),(0,i.createElementVNode)("div",s,[(0,i.createElementVNode)("div",o,[l.listing.imageUrl?((0,i.openBlock)(),(0,i.createElementBlock)("img",{key:0,src:l.listing.imageUrl,alt:l.listing.name,class:"bid-modal__nft-image"},null,8,d)):((0,i.openBlock)(),(0,i.createElementBlock)("div",c,t[4]||(t[4]=[(0,i.createElementVNode)("i",{class:"fas fa-image bid-modal__nft-placeholder-icon"},null,-1)])))]),(0,i.createElementVNode)("h4",r,(0,i.toDisplayString)(l.listing.name||`NFT #${l.listing.mintAddress.substring(0,8)}`),1)]),(0,i.createElementVNode)("form",{onSubmit:t[2]||(t[2]=(0,i.withModifiers)(((...e)=>B.submitBid&&B.submitBid(...e)),["prevent"])),class:"bid-modal__form"},[(0,i.createElementVNode)("div",m,[t[5]||(t[5]=(0,i.createElementVNode)("label",{class:"bid-modal__form-label"},[(0,i.createElementVNode)("span",{class:"bid-modal__form-label-text"},"Current Price")],-1)),(0,i.createElementVNode)("input",{value:B.formatPrice(l.listing.highestBid||l.listing.initialPrice),type:"text",class:"bid-modal__form-input bid-modal__form-input--disabled",disabled:""},null,8,u)]),(0,i.createElementVNode)("div",g,[t[6]||(t[6]=(0,i.createElementVNode)("label",{class:"bid-modal__form-label"},[(0,i.createElementVNode)("span",{class:"bid-modal__form-label-text"},"Your Bid (SOL)")],-1)),(0,i.withDirectives)((0,i.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.bidAmount=e),type:"number",step:"0.01",min:B.minBidAmount,placeholder:"Enter bid amount",class:"bid-modal__form-input",required:""},null,8,_),[[i.vModelText,h.bidAmount]]),(0,i.createElementVNode)("span",p,"Minimum bid: "+(0,i.toDisplayString)(B.minBidAmount)+" SOL",1)]),(0,i.createElementVNode)("div",b,[t[9]||(t[9]=(0,i.createElementVNode)("h4",{class:"bid-modal__fee-title"},"Fees",-1)),(0,i.createElementVNode)("div",v,[t[7]||(t[7]=(0,i.createElementVNode)("span",null,"Marketplace Fee (5%)",-1)),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(B.calculateFee())+" SOL",1)]),(0,i.createElementVNode)("div",N,[t[8]||(t[8]=(0,i.createElementVNode)("span",null,"Total",-1)),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(B.calculateTotal())+" SOL",1)])]),(0,i.createElementVNode)("div",k,[(0,i.createElementVNode)("button",{type:"button",class:"bid-modal__button bid-modal__button--cancel",onClick:t[1]||(t[1]=t=>e.$emit("close"))},"Cancel"),(0,i.createElementVNode)("button",{type:"submit",class:"bid-modal__button bid-modal__button--submit",disabled:l.isSubmitting||!B.isFormValid},[l.isSubmitting?((0,i.openBlock)(),(0,i.createElementBlock)("span",V)):(0,i.createCommentVNode)("",!0),t[10]||(t[10]=(0,i.createTextVNode)(" Place Bid "))],8,E)])],32)]),(0,i.createElementVNode)("div",{class:"bid-modal__backdrop",onClick:t[3]||(t[3]=t=>e.$emit("close"))})])}var h={name:"PlaceBidModal",props:{listing:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1}},data(){return{bidAmount:""}},computed:{minBidAmount(){const e=this.listing.highestBid||this.listing.initialPrice;return(parseFloat(e)+.01).toFixed(2)},isFormValid(){return this.bidAmount&&parseFloat(this.bidAmount)>=parseFloat(this.minBidAmount)}},methods:{formatPrice(e){return parseFloat(e).toFixed(3)},calculateFee(){if(!this.bidAmount)return"0";const e=.05*parseFloat(this.bidAmount);return e.toFixed(3)},calculateTotal(){if(!this.bidAmount)return"0";const e=parseFloat(this.bidAmount),t=.05*e;return(e+t).toFixed(3)},submitBid(){this.isFormValid&&this.$emit("submit",{mintAddress:this.listing.mintAddress,amount:parseFloat(this.bidAmount)})}},mounted(){this.bidAmount=this.minBidAmount}},B=l(1241);const y=(0,B.A)(h,[["render",f],["__scopeId","data-v-fe5ce5c6"]]);var C=y},2118:function(e,t,l){l.r(t),l.d(t,{default:function(){return Q}});var i=l(4061);const a={class:"listing-detail"},n={class:"listing-detail__container"},s={key:0,class:"listing-detail__loader-container"},o={key:1,class:"listing-detail__not-found"},d={key:2,class:"listing-detail__content"},c={class:"listing-detail__grid"},r={class:"listing-detail__image-section"},m={class:"listing-detail__image-container"},u=["src","alt"],g={key:1,class:"listing-detail__image-placeholder"},_={class:"listing-detail__info-section"},p={class:"listing-detail__header"},b={class:"listing-detail__title"},v={class:"listing-detail__address"},N={key:0,class:"listing-detail__status"},k={key:0,class:"listing-detail__seller-info"},E={class:"listing-detail__seller-tag"},V={class:"listing-detail__seller"},f={class:"listing-detail__seller-value"},h={class:"listing-detail__price-section"},B={class:"listing-detail__price-block"},y={class:"listing-detail__price-value"},C={key:0,class:"listing-detail__price-block"},A={class:"listing-detail__price-value"},S={class:"listing-detail__time-block"},w={class:"listing-detail__time-value"},D={class:"listing-detail__time-date"},P={key:1,class:"listing-detail__bid-section"},F={key:0,class:"listing-detail__highest-bid"},M={class:"listing-detail__bid-value"},T={class:"listing-detail__bidder"},x={key:0,class:"listing-detail__bidder-you"},L={class:"listing-detail__actions"},$={key:2,class:"listing-detail__description"},O={class:"listing-detail__description-text"},U={class:"listing-detail__back-link-container"};function R(e,t,l,R,I,W){const q=(0,i.resolveComponent)("router-link"),H=(0,i.resolveComponent)("PlaceBidModal"),K=(0,i.resolveComponent)("CancelListingModal");return(0,i.openBlock)(),(0,i.createElementBlock)("div",a,[(0,i.createElementVNode)("div",n,[R.isLoading?((0,i.openBlock)(),(0,i.createElementBlock)("div",s,t[5]||(t[5]=[(0,i.createElementVNode)("div",{class:"listing-detail__loader"},null,-1)]))):R.listing?((0,i.openBlock)(),(0,i.createElementBlock)("div",d,[(0,i.createElementVNode)("div",c,[(0,i.createElementVNode)("div",r,[(0,i.createElementVNode)("div",m,[R.listing.imageUrl?((0,i.openBlock)(),(0,i.createElementBlock)("img",{key:0,src:R.listing.imageUrl,alt:R.listing.name,class:"listing-detail__image"},null,8,u)):((0,i.openBlock)(),(0,i.createElementBlock)("div",g,t[9]||(t[9]=[(0,i.createElementVNode)("i",{class:"fas fa-image listing-detail__placeholder-icon"},null,-1)])))])]),(0,i.createElementVNode)("div",_,[(0,i.createElementVNode)("div",p,[(0,i.createElementVNode)("div",null,[(0,i.createElementVNode)("h1",b,(0,i.toDisplayString)(R.listing.name||`NFT #${R.listing.mintAddress.substring(0,8)}`),1),(0,i.createElementVNode)("p",v,(0,i.toDisplayString)(R.shortenAddress(R.listing.mintAddress)),1)]),"active"!==R.listing.status?((0,i.openBlock)(),(0,i.createElementBlock)("div",N,[(0,i.createElementVNode)("span",{class:(0,i.normalizeClass)(["listing-detail__status-badge",{"listing-detail__status-badge--sold":"sold"===R.listing.status,"listing-detail__status-badge--cancelled":"cancelled"===R.listing.status,"listing-detail__status-badge--expired":"expired"===R.listing.status}])},(0,i.toDisplayString)(R.listing.status),3)])):(0,i.createCommentVNode)("",!0)]),R.listing.seller&&R.listing.seller.userTag?((0,i.openBlock)(),(0,i.createElementBlock)("div",k,[t[10]||(t[10]=(0,i.createElementVNode)("h3",{class:"listing-detail__seller-title"},"Seller",-1)),(0,i.createElementVNode)("p",E,(0,i.toDisplayString)(R.listing.seller.userTag),1)])):(0,i.createCommentVNode)("",!0),(0,i.createElementVNode)("div",V,[t[11]||(t[11]=(0,i.createElementVNode)("p",{class:"listing-detail__seller-label"},"Продавец",-1)),(0,i.createElementVNode)("p",f,(0,i.toDisplayString)(R.listing.seller&&(R.listing.seller.displayName||R.listing.seller.userTag)||R.shortenAddress(R.listing.sellerWallet)),1)]),(0,i.createElementVNode)("div",h,[(0,i.createElementVNode)("div",B,[t[12]||(t[12]=(0,i.createElementVNode)("p",{class:"listing-detail__price-label"},"Текущая цена",-1)),(0,i.createElementVNode)("p",y,(0,i.toDisplayString)(R.formatPrice(R.listing.highestBid||R.listing.initialPrice))+" SOL",1)]),R.listing.instantPrice?((0,i.openBlock)(),(0,i.createElementBlock)("div",C,[t[13]||(t[13]=(0,i.createElementVNode)("p",{class:"listing-detail__price-label"},"Цена мгновенной покупки",-1)),(0,i.createElementVNode)("p",A,(0,i.toDisplayString)(R.formatPrice(R.listing.instantPrice))+" SOL",1)])):(0,i.createCommentVNode)("",!0)]),(0,i.createElementVNode)("div",S,[t[14]||(t[14]=(0,i.createElementVNode)("p",{class:"listing-detail__time-label"},"Аукцион завершается",-1)),(0,i.createElementVNode)("p",w,(0,i.toDisplayString)(R.formatTimeRemaining(R.listing.endTime)),1),(0,i.createElementVNode)("p",D,(0,i.toDisplayString)(R.formatDate(R.listing.endTime)),1)]),"active"===R.listing.status?((0,i.openBlock)(),(0,i.createElementBlock)("div",P,[R.listing.highestBid?((0,i.openBlock)(),(0,i.createElementBlock)("div",F,[t[15]||(t[15]=(0,i.createElementVNode)("p",{class:"listing-detail__bid-label"},"Текущая ставка",-1)),(0,i.createElementVNode)("p",M,(0,i.toDisplayString)(R.formatPrice(R.listing.highestBid))+" SOL",1),(0,i.createElementVNode)("p",T,[(0,i.createTextVNode)(" от "+(0,i.toDisplayString)(R.listing.highestBidder&&R.listing.highestBidder.userTag||R.shortenAddress(R.listing.highestBidder))+" ",1),R.isCurrentUserHighestBidder?((0,i.openBlock)(),(0,i.createElementBlock)("span",x,"(Вы)")):(0,i.createCommentVNode)("",!0)])])):(0,i.createCommentVNode)("",!0),(0,i.createElementVNode)("div",L,[R.canBid?((0,i.openBlock)(),(0,i.createElementBlock)("button",{key:0,onClick:t[0]||(t[0]=e=>R.showBidModal=!0),class:"listing-detail__bid-button"}," Сделать ставку ")):(0,i.createCommentVNode)("",!0),R.canBuyNow?((0,i.openBlock)(),(0,i.createElementBlock)("button",{key:1,onClick:t[1]||(t[1]=(...e)=>R.buyNow&&R.buyNow(...e)),class:"listing-detail__buy-button"}," Купить сейчас за "+(0,i.toDisplayString)(R.formatPrice(R.listing.instantPrice))+" SOL ",1)):(0,i.createCommentVNode)("",!0),R.canCancel?((0,i.openBlock)(),(0,i.createElementBlock)("button",{key:2,onClick:t[2]||(t[2]=e=>R.showCancelModal=!0),class:"listing-detail__cancel-button"}," Отменить листинг ")):(0,i.createCommentVNode)("",!0)])])):(0,i.createCommentVNode)("",!0),R.listing.nftDetails&&R.listing.nftDetails.description?((0,i.openBlock)(),(0,i.createElementBlock)("div",$,[t[16]||(t[16]=(0,i.createElementVNode)("h3",{class:"listing-detail__description-title"},"Описание",-1)),(0,i.createElementVNode)("p",O,(0,i.toDisplayString)(R.listing.nftDetails.description),1)])):(0,i.createCommentVNode)("",!0)])])])):((0,i.openBlock)(),(0,i.createElementBlock)("div",o,[t[7]||(t[7]=(0,i.createElementVNode)("h2",{class:"listing-detail__not-found-title"},"Листинг не найден",-1)),t[8]||(t[8]=(0,i.createElementVNode)("p",{class:"listing-detail__not-found-message"},"NFT листинг, который вы ищете, не существует или был удален.",-1)),(0,i.createVNode)(q,{to:"/nft-market",class:"listing-detail__back-button"},{default:(0,i.withCtx)((()=>t[6]||(t[6]=[(0,i.createTextVNode)("Вернуться на маркетплейс")]))),_:1})])),(0,i.createElementVNode)("div",U,[(0,i.createVNode)(q,{to:"/nft-market",class:"listing-detail__back-link"},{default:(0,i.withCtx)((()=>t[17]||(t[17]=[(0,i.createElementVNode)("i",{class:"fas fa-arrow-left listing-detail__back-icon"},null,-1),(0,i.createTextVNode)(" Назад к маркетплейсу ")]))),_:1})])]),R.showBidModal&&R.listing?((0,i.openBlock)(),(0,i.createBlock)(H,{key:0,listing:R.listing,"is-submitting":R.isPlacingBid,onClose:t[3]||(t[3]=e=>R.showBidModal=!1),onSubmit:R.handlePlaceBid},null,8,["listing","is-submitting","onSubmit"])):(0,i.createCommentVNode)("",!0),R.showCancelModal&&R.listing?((0,i.openBlock)(),(0,i.createBlock)(K,{key:1,"is-submitting":R.isCancelling,onClose:t[4]||(t[4]=e=>R.showCancelModal=!1),onConfirm:R.handleCancelListing},null,8,["is-submitting","onConfirm"])):(0,i.createCommentVNode)("",!0)])}var I=l(3992),W=l(6659),q=l(3719),H=l.n(q),K=l(6241),Y=l(9710),j=l(4348),z={name:"NftListingDetailPage",components:{PlaceBidModal:K.A,CancelListingModal:Y.A},setup(){const e=(0,I.useRoute)(),{wallet:t,connected:l,publicKey:a}=((0,I.useRouter)(),(0,W.vT)()),n=(0,i.ref)(null),s=e.params.mintAddress,o=(0,i.ref)(!0),d=(0,i.ref)(!1),c=(0,i.ref)(!1),r=(0,i.ref)(!1),m=(0,i.ref)(!1),u=(0,i.computed)((()=>a.value?a.value.toString():"")),g=(0,i.computed)((()=>n.value&&n.value.highestBidder&&u.value===n.value.highestBidder)),_=(0,i.computed)((()=>l.value&&n.value&&"active"===n.value.status&&n.value.sellerWallet!==u.value&&new Date(n.value.endTime)>new Date)),p=(0,i.computed)((()=>_.value&&n.value.instantPrice)),b=(0,i.computed)((()=>l.value&&n.value&&"active"===n.value.status&&n.value.sellerWallet===u.value)),v=async()=>{try{o.value=!0;const e=await H().get(`/nft-market/listings/mint/${s}`);n.value=e.data.data}catch(e){j.error("Error loading listing:",e),n.value=null}finally{o.value=!1}},N=()=>{p.value&&(r.value=!0)},k=async e=>{try{d.value=!0;await H().post("/nft-market/bid",{mintAddress:e.mintAddress,bidAmount:e.amount});r.value=!1,await v()}catch(t){j.error("Error placing bid:",t),alert("Failed to place bid. Please try again.")}finally{d.value=!1}},E=async()=>{try{c.value=!0;await H().post("/nft-market/listings/cancel",{mintAddress:n.value.mintAddress});m.value=!1,await v()}catch(e){j.error("Error cancelling listing:",e),alert("Failed to cancel listing. Please try again.")}finally{c.value=!1}},V=e=>parseFloat(e).toFixed(3),f=e=>{const t=new Date(e),l=new Date;if(t<=l)return"Ended";const i=t-l,a=Math.floor(i/864e5),n=Math.floor(i%864e5/36e5),s=Math.floor(i%36e5/6e4);return a>0?`${a}d ${n}h ${s}m`:n>0?`${n}h ${s}m`:`${s}m`},h=e=>{const t=new Date(e);return t.toLocaleString()},B=e=>e?`${e.substring(0,4)}...${e.substring(e.length-4)}`:"";return(0,i.onMounted)((()=>{v()})),{listing:n,isLoading:o,isPlacingBid:d,isCancelling:c,showBidModal:r,showCancelModal:m,isCurrentUserHighestBidder:g,canBid:_,canBuyNow:p,canCancel:b,buyNow:N,handlePlaceBid:k,handleCancelListing:E,formatPrice:V,formatTimeRemaining:f,formatDate:h,shortenAddress:B}}},G=l(1241);const J=(0,G.A)(z,[["render",R],["__scopeId","data-v-03efaec2"]]);var Q=J}}]);
//# sourceMappingURL=118.6586e9bb.js.map